Press 5 on numpad to start farm. Make sure numlock is disabled.
Minimize minecraft by (1) having minecraft in a windowed state and (2) pressing the windows key and the down arrow key before the macro begins.
Set up farm via an 8 by x rectangle of soul sand, and for each row of soul sand, place a fence two blocks above the soul sand for all but the soul sand on the left. Surround everything with cobblestone.
Make sure to update window name of the minecraft window for each minecraft update.
You can exit the macro by pressing windows key + down arrow key when the player is either moving forwards or backwards.
Macro works only if user has buff speed II present.
Modify the line "distance := 64" to "distance := <length of farm before running>". 